<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>App-365 Bolos</title>

<!-- PWA INLINE -->
<link rel="manifest" href="data:application/json,{
  &quot;name&quot;:&quot;App-365 Bolos&quot;,
  &quot;short_name&quot;:&quot;Bolos&quot;,
  &quot;start_url&quot;:&quot;.&quot;,
  &quot;display&quot;:&quot;standalone&quot;,
  &quot;background_color&quot;:&quot;#f5f5f5&quot;,
  &quot;theme_color&quot;:&quot;#f57c00&quot;,
  &quot;icons&quot;:[{
    &quot;src&quot;:&quot;data:image/png;base64,iVBORw0KGgo=&quot;,
    &quot;sizes&quot;:&quot;192x192&quot;,
    &quot;type&quot;:&quot;image/png&quot;
  }]
}">

<style>
body {
  margin: 0;
  font-family: Arial, sans-serif;
  background: #f2f2f2;
}

header {
  background: #f57c00;
  color: #fff;
  padding: 20px;
  text-align: center;
}

header img {
  max-width: 140px;
  margin-bottom: 10px;
}

.container {
  padding: 15px;
}

input, button {
  width: 100%;
  padding: 12px;
  margin-top: 10px;
  font-size: 16px;
}

button {
  background: #f57c00;
  color: white;
  border: none;
  border-radius: 6px;
}

.grid {
  display: grid;
  grid-template-columns: repeat(auto-fill,minmax(140px,1fr));
  gap: 12px;
}

.card {
  background: #fff;
  border-radius: 10px;
  padding: 15px;
  text-align: center;
  font-size: 18px;
  cursor: pointer;
}

.modal {
  position: fixed;
  top:0; left:0;
  width:100%; height:100%;
  background: rgba(0,0,0,.6);
  display:none;
}

.modal-content {
  background:#fff;
  margin:5%;
  padding:15px;
  border-radius:10px;
  max-height:85%;
  overflow:auto;
}

.close {
  text-align:right;
  font-size:18px;
  cursor:pointer;
}
</style>
</head>

<body>

<!-- LOGIN -->
<div id="login">
  <header>
    <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/6/6b/Cake_icon.svg/512px-Cake_icon.svg.png">
    <h1>üéÇ App-365 Bolos</h1>
  </header>
  <div class="container">
    <input type="password" id="senha" placeholder="Digite a senha">
    <button onclick="entrar()">Entrar</button>
  </div>
</div>

<!-- APP -->
<div id="app" style="display:none;">
  <header><h2>üç∞ Receitas</h2></header>
  <div class="container">
    <div class="grid" id="lista"></div>
  </div>
</div>

<!-- MODAL -->
<div class="modal" id="modal">
  <div class="modal-content" id="conteudo">
    <div class="close" onclick="fechar()">‚úñ</div>
  </div>
</div>

<script>
const SENHA = "1950*";
const SHEET_ID = "1q-B4wKUJtpmjh3MoXae9xR0HVg9EYvsF2QD3guVm_Os";
const ABA = "sheet1";

function entrar() {
  if (senha.value === SENHA) {
    login.style.display = "none";
    app.style.display = "block";
    carregar();
  } else {
    alert("Senha incorreta");
  }
}

async function carregar() {
  const url = `https://opensheet.elk.sh/${SHEET_ID}/${ABA}`;
  const dados = await fetch(url).then(r => r.json());
  lista.innerHTML = "";
  dados.forEach(r => {
    const div = document.createElement("div");
    div.className = "card";
    div.innerHTML = `<div style="font-size:40px">${emoji(r.categoria)}</div><b>${r.nome}</b>`;
    div.onclick = () => abrir(r);
    lista.appendChild(div);
  });
}

function emoji(cat){
  if(!cat) return "üéÇ";
  cat = cat.toLowerCase();
  if(cat.includes("banana")) return "üçå";
  if(cat.includes("chocolate")) return "üç´";
  if(cat.includes("cenoura")) return "ü•ï";
  return "üéÇ";
}

function abrir(r){
  conteudo.innerHTML = `
  <div class="close" onclick="fechar()">‚úñ</div>
  <h2>${r.nome}</h2>
  <p><b>Identifica√ß√£o:</b> ${r.identificacao}</p>
  <p><b>Ingredientes:</b><br>${r.ingredientes}</p>
  <p><b>Tempo:</b> ${r.tempo}</p>
  <p><b>Temperatura:</b> ${r.temperatura}</p>
  <p><b>Modo de Preparo:</b><br>${r.modo_preparo}</p>
  <p><b>T√©cnicas:</b> ${r.tecnicas}</p>
  <p><b>Rendimento:</b> ${r.rendimento}</p>
  <p><b>Dificuldade:</b> ${r.dificuldade}</p>
  <p><b>Categoria:</b> ${r.categoria}</p>
  <p><b>Observa√ß√µes:</b> ${r.observacoes}</p>
  `;
  modal.style.display="block";
}

function fechar(){
  modal.style.display="none";
}

/* SERVICE WORKER INLINE */
if ('serviceWorker' in navigator) {
  const sw = `
  self.addEventListener('install', e => self.skipWaiting());
  self.addEventListener('fetch', e => {});
  `;
  const blob = new Blob([sw], {type: 'text/javascript'});
  const url = URL.createObjectURL(blob);
  navigator.serviceWorker.register(url);
}
</script>

</body>
</html>
